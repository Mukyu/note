# 一些常见的工作流程

## 什么？已发布的产品里有BUG？

情况描述：已经发布的产品分支上（通常是master分支）发现有bug需要紧急修复并发布！

1. 检查当前的工作状态，若当前有尚未提交的修改，则缓存当前的工作状态，以免在这些修改在切换分支后覆盖到所切换的分支上。在当前的工作分支上运行`git stash -a`将当前的工作状态暂时保存起来。保证当前的工作环境的‘干净’。
2. 切换到需要解决bug的分支，例如用于正式发布产品的分支，一般为master分支。`git checkout master`。
3. 新建bug修复分支，`git checkout -b issue-001`。
4. 修复bug并测试通过。
5. 将修复合并到master分支上。在一般情况下，master分支在bug修复期间没有被更新过的话，只要切换到master分支并将bug修复的分支合并即可，运行`git checkout master` `git merge issue-001`。若在bug修复期间，master有重新发布了一个新的版本。且在该版本上没有修复该bug，这时依旧可以切换到master分支上并将issue-001分支上的修改合并进来。或者用rebase命令将issue-001上的修改重新应用到master分支的最新版本上，在测试通过后，切换到master分支上与issue-001合并，操作如下，`git rebase master` `git checkout master` `git merge issue-001`。rebase的好处是可以使master分支相对线性。使master上面只有来自dev分支的合并。
6. 发布完毕。现在可以删除issue-001分支。

## 忘记在.gitignore文件里添加过滤信息，把不需要的文件`commit`了。

情况描述：把编译过程中自动生成的文件`commit`上去了，导致今后的提交中也会多出很多无用的提交。

1. 首先，先更新.gitignore文件，告诉git哪些是我们不需要提交的文件。当然，这只是告诉git今后需要忽略掉哪些文件。当前已经`commit`的、需要被忽略的文件，还是会被持续跟踪。
2. 接着，我们只要将不需要的文件删除即可。你可以直接在文件管理器中把不需要的文件删除，接着执行`git add`或者`git rm`将这些删除改动提交即可，或者直接执行`git rm`，它的作用和上述操作的结果是一样的。
3. 或者，我们不想要删除这些文件，只是希望git停止跟踪这些文件。可以执行`git rm --cached`将文件仅从暂存区移除。接着，由于我们设置好了.gitignore文件，这些文件将不会再被跟踪。

可以看出：
- `git add`的本质是提交文件的改动（包括删除）。
- .gitignore文件的作用是过滤掉未跟踪的文件，已跟踪的文件则不受影响。
